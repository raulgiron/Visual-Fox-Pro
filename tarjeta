SET EXCLUSIVE OFF

USE t_personal IN 1

SELECT 1
GO TOP

* Crear un objeto de Excel
oExcel = CREATEOBJECT("Excel.Application")
oExcel.Visible = .F.  && Si deseas que Excel sea visible, usa .T.

* Abrir el libro de Excel
oWorkbook = oExcel.Workbooks.Open("C:\ruta\al\archivo.xls")

* Seleccionar la hoja de trabajo
oSheet = oWorkbook.Sheets(1)  && Selecciona la primera hoja

DO WHILE NOT EOF()
    * Recorrer las filas del archivo de Excel
    FOR i = 2 TO oSheet.UsedRange.Rows.Count
        cNombreExcel = oSheet.Cells(i, 1).Value
        cApellidoExcel = oSheet.Cells(i, 2).Value
        cCedulaExcel = oSheet.Cells(i, 3).Value
        
        * Comprobar si coinciden nombre y apellido
        IF t_personal.ps_nombres == cNombreExcel AND t_personal.ps_apellidos == cApellidoExcel
            * Actualizar la tabla t_personal con la c√©dula de Excel
            REPLACE t_personal.ps_cedula WITH cCedulaExcel IN t_personal
        ENDIF
    NEXT

    SKIP 1
    IF EOF()
        EXIT
    ENDIF
ENDDO

* Cerrar el libro de Excel
oWorkbook.Close(.F.)  && No guardar cambios
oExcel.Quit()
RELEASE oExcel

WAIT WINDOW 'proceso terminado'
